<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Nada Sandbox</title>
    <script>
      var favIcon = "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGFBMVEUAAABHcEwAAAAAAAAAAAAAAAAAAAAAAACpMnD0AAAAB3RSTlNjAL+fpPk8rO4B2AAAADNJREFUGJVjYEQDDIxsLMxwwMIGFGBgRwIMOAVYgQBZgAlkHNMgEwB6joUB7E8WiOfQAADiPANLertncwAAAABJRU5ErkJggg==";
      var docHead = document.getElementsByTagName('head')[0];
      var newLink = document.createElement('link');
      newLink.rel = 'shortcut icon';
      newLink.type = 'image/x-icon';
      newLink.href = 'data:image/png;base64,'+favIcon;
      docHead.appendChild(newLink);
    </script>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cabin" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css"></link>
    <link rel="stylesheet" href="https://codemirror.net/5/addon/scroll/simplescrollbars.css"></link>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/monokai.min.css"></link>
    <style>
      body { min-width:1200px; font-family:'Cabin',sans-serif; }
      #pyscript_loading_splash { }
      .container { max-width:1260px; }
      main { padding:40px; }
      .flex-equal > * { flex:1; }
      @media (min-width: 768px) { .flex-md-equal > * { flex:1; } }
      .header { padding-bottom:24px; font-size:18px; }
      .header > h2 { margin-bottom:2px; font-weight:400; }
      .header > hr { width:100%; margin:0px 0px 6px 0px; border-top:1px solid #000000; opacity:1; }

      #manager { padding:6px; }
      #permalink { width:100%; border:1px solid #000000; font-size:12px; font-family:Monospace; }
      #permalink-copy { 
        width:100%;
        padding:6px 6px 6px 6px;
        border:1px solid #000000;
        background-color:#0000FF;
        font-size:14px;
        color:#FFFFFF;
      }
      #examples {
        overflow:hidden;
        border:1px solid #000000;
        padding:4px;
        background-color:#F0F0F0;
        font-size:11px;
      }
      .example { display:none; }
      .example-link { cursor:pointer; }
      .example-link:hover { background-color:#444444; color:#FFFFFF; cursor:pointer; }
      .example-link-selected { background-color:blue; color:#FFFFFF; }
      .example-link-selected:hover { background-color:blue; color:#FFFFFF; }

      #editor-container { font-size:12px; }
      #report-container { position:absolute; border:1px solid #777777; padding:5px; overflow:hidden; }
      #report { position:relative; font-family:Monospace; font-size:12px; }

      .keyword { font-weight:bold; color:#000000; }
      .rules-SyntaxError { background-color:#FFFF00; color:#555555; }
      .rules-SyntaxRestriction { background-color:#CCCC00; font-weight:bold; color:#000000; }
      .types-TypeError { background-color:#FFCCCB; font-weight:bold; color:#B22222; }
      .types-TypeErrorRoot { background-color:#FF0000; font-weight:bold; color:#FFFFFF ; }
      .types-str { font-weight:bold; color:#000000; }
      .types-int { font-weight:bold; color:#000000; }
      .types-Party { font-weight:bold; color:#d45cd6; }
      .types-Input { font-weight:bold; color:#DAA520; }
      .types-Output { font-weight:bold; color:#DAA520; }
      .types-PublicInteger { font-weight:bold; color:#009900; }
      .types-SecretInteger { font-weight:bold; color:#0000FF; }
      #report > div { height:18px; line-height:18px; white-space:pre; }
      #report > div span { padding-top:3px; padding-bottom:3px; line-height:18px; cursor:pointer; }
      .detail { cursor:pointer; }
      .detail:hover { background-color:#DDDDDD; }
      #detail {
        display:none;
        position:absolute;
        height:40px !important;
        padding:12px;
        background-color:#000000;
        color:#FFFFFF;
      }

      .tooltip { font-size:14px; }
      .tooltip table { margin:4px 0px 4px 0px; border:1px solid #888888; }
      .tooltip td { padding:6px; border:1px solid #888888; text-align:left; }

      .panel-io { width:50%; margin:8px; font-family:Monospace; font-size:12px; font-weight:bold; }
      .panel-io table { width:100%; border:1px solid #BBBBBB; }
      .panel-io td { height:32px; padding:4px; border:1px solid #BBBBBB; }
      .panel-io input { border:1px solid #000000; }

      .panel-tab {
        padding:8px;
        border-top:1px solid #000000;
        border-left:1px solid #000000; 
        border-bottom:1px solid #000000;
        background-color:#F0F0F0;
        line-height:16px;
        cursor:pointer;
      }
      .panel {
        min-height:300px;
        background-color:#F0F0F0;
      }

      .noselect {
        -webkit-touch-callout:none; /* iOS Safari */
          -webkit-user-select:none; /* Safari */
           -khtml-user-select:none; /* Konqueror HTML */
             -moz-user-select:none; /* Old versions of Firefox */
              -ms-user-select:none; /* Internet Explorer/Edge */
                  user-select:none; /* Non-prefixed version, currently
                                       supported by Chrome, Edge, Opera and Firefox */
      }

      .CodeMirror-overlayscroll-vertical { width:10px; }
      .CodeMirror-overlayscroll-horizontal { height:10px; }
      .CodeMirror-scrollbar-filler { background-color:#777777;}
    </style>
  </head>
  <body>
    <main>
      <div>
        <div class="header noselect" id="header">
          <h2><b>Nada</b> Sandbox</h2>
          <hr/>
          <span>Write, analyze, and simulate Nada programs in your browser.</span>
        </div>
        <div style="display:table; width:100%;">
          <div style="display:table-row; width:100%;">
            <div style="display:table-cell; width:160px;">
              <div id="manager">
                <div style="position:relative; top:5px;">
                  <button id="permalink-copy">
                    Copy permanent link to clipboard
                  </button>
                  <input id="permalink" type="text" onclick="this.select();" />
                </div>
                <br/>
                <div id="examples">
                  <b>Select an example:</b>
                  <hr style="margin:4px 0px 4px 0px;"/>
                </div>
              </div>
            </div>
            <div style="display:table-cell; width:calc(100% - 160px);" id="views">
              <div style="display:table;">
                <div style="display:table-row;">
                  <div id="editor-container" style="display:table-cell; width:50%;">
                    <textarea id="editor"></textarea>
                  </div>
                  <div id="report-container" style="display:table-cell;">
                    <textarea id="payload" style="display:none;"></textarea>
                    <div id="report" style="font-family:Monospace; text-align:left;">loading</div>
                  </div>
                </div>
              </div>
              <py-config>
                packages = ["parsial~=0.1", "richreports~=0.2", "asttokens~=2.4"]

                [[fetch]]
                files = ['nada_audit.py']
              </py-config>
              <section class="pyscript">
                <py-script>
                  from js import document
                  from pyodide.ffi import create_proxy, to_js
                  import types
                  import json
                  import ast
                  import inspect
                  import asttokens
                  from nada_audit import *

                  def update(_):
                      source = \
                          document.getElementById('payload').innerHTML \
                          .replace('&' + 'amp;', '&') \
                          .replace('&' + 'lt;', '<') \
                          .replace('&' + 'gt;', '>')

                      # Perform static analyses and render the report.
                      try:
                          lines = source.split('\n')
                          report = audit(source)
                          rlines = report.render().split('\n')
                          js.reportDisplay(to_js(rlines))
                      except Exception as e:
                          pass

                      # Perform abstract interpretation to determine inputs
                      # and then simulate the program on the inputs (either
                      # randomly generated or user-supplied).
                      try:
                          ins = js.interpreterInputsRetrieve()
                          context = {}
                          Abstract.initialize(ins.to_py())
                          exec(source, context)
                          outs = context['nada_main']()
                          if len(outs) > 0:
                              js.interpreterInputsShow(to_js([i.name for i in outs[0].inputs]))
                              js.interpreterOutputsShow(
                                  to_js([[o.name, o.value.value] for o in outs[0].outputs])
                              )
                      except Exception as e:
                          pass

                  document.addEventListener('update', create_proxy(update))
                  pyscript.write('report', 'ready')
                  js.update()
                </py-script>
              </section>
            </div>
          </div>
          <div style="display:table-row; width:100%;">
            <div style="display:table-cell; width:160px; padding:12px 0px 12px 12px; font-size:12px; font-weight:bold;">
              <div class="panel-tab">
                <b>Interpreter with Inputs/Outputs</b>
                <hr style="margin:4px 0px 4px 0px;"/>
                Input boxes are generated automatically from the source. Editing inputs updates outputs via Python-only execution of the source.
              </div>
            </div>
            <div style="display:table-cell; width:calc(100% - 160px);">
              <div class="panel" id="interpreter" style="display:inline-flex; width:100%;">
                <div class="panel-io" id="inputs"></div>
                <div class="panel-io" id="outputs"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer class="text-center text-lg-start bg-light text-muted fixed-bottom">
      <div class="text-center p-4" style="background-color:rgb(0,0,255);">
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script type="text/javascript" src="https://codemirror.net/5/addon/scroll/simplescrollbars.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/python/python.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <script>
      class Manager {
        constructor (elementId, width, editor) {
          this.element = document.getElementById(elementId);
          this.width = width;
          this.editor = editor;
        }

        sizeUpdate () {
          this.element.setAttribute("style", "width:" + this.width + "px");
          this.element.parentElement.setAttribute("style", "width:" + this.width + "px");
        }

        buildExampleMenu () {
          // Build links to load example programs.
          const textareas = document.querySelectorAll('.example');
          const links = document.getElementById('examples');
          for (let i = 0; i < textareas.length; i++) {
            const div = document.createElement("div");
            div.appendChild(document.createTextNode(textareas[i].id));
            div.classList.add("example-link");
            if (i == 0) {
              div.classList.add("example-link-selected");
            }
            const self = this;
            div.onclick = function () {
              const links_ = document.querySelectorAll('.example-link');
              for (let j = 0; j < links_.length; j++) {
                links_[j].className = "example-link";
              }
              div.classList.add("example-link-selected");
              self.editor.codeMirror.setValue(document.getElementById(textareas[i].id).innerText);
              update();
            };
            links.appendChild(div);
          }
        }

        buildPermalinkButton () {
          // Add event handler for link generator.
          const self = this;
          document.querySelector("#permalink-copy").addEventListener("click", async function () {
            // Based on example at:
            // https://dev.to/samternent/json-compression-in-the-browser-with-gzip-and-the-compression-streams-api-4135
            const stream = new Blob([self.editor.codeMirror.getValue()], {type: 'text/plain'}).stream();
            const compressedReadableStream = stream.pipeThrough(new CompressionStream("gzip"));
            const compressedResponse = await new Response(compressedReadableStream);
            const blob = await compressedResponse.blob();
            const buffer = await blob.arrayBuffer();
            const compressedBase64 = encodeURIComponent(btoa(String.fromCharCode( ...new Uint8Array(buffer))));
            document.getElementById("permalink").value = (
              location.protocol + '//' + location.host + location.pathname +
              '?s=' + compressedBase64 // For no compression: btoa(self.editor.codeMirror.getValue())
            );
            document.querySelector("#permalink").select();
            document.execCommand("copy");
          });
        }

        async loadInitialSource () {
          // Load the default example (or decode the supplied permalink).
          let value = document.getElementById("multiplication_mixed_simple").innerText;
          const urlParams = new URLSearchParams(window.location.search);
          if (urlParams.has('s')) {
            // Based on example at:
            // https://dev.to/samternent/json-compression-in-the-browser-with-gzip-and-the-compression-streams-api-4135
            function b64decode(str) {
              const binary_string = window.atob(str);
              const len = binary_string.length;
              const bytes = new Uint8Array(new ArrayBuffer(len));
              for (let i = 0; i < len; i++) {
                bytes[i] = binary_string.charCodeAt(i);
              }
              return bytes;
            }
            const compressed = b64decode(decodeURIComponent(urlParams.get('s')));
            const stream = new Blob([compressed], {type: "text/plain"}).stream();
            const compressedReadableStream = stream.pipeThrough(new DecompressionStream("gzip"));
            const resp = await new Response(compressedReadableStream);
            const blob = await resp.blob();
            value = await blob.text(); // For no compression: atob(b64compressed);
          }
          this.editor.codeMirror.setValue(value);
        }
      }

      class Editor {
        constructor (elementId, lines, sidebar, update) {
          this.element = document.getElementById(elementId);
          this.lines = lines; // Number of lines displayed in interactive editor.
          this.sidebar = sidebar; // Width of sidebar in pixels.

          // Creaete and configure CodeMirror instance.
          this.codeMirror = new CodeMirror.fromTextArea(
            this.element,
            {
              lineNumbers: true,
              viewportMargin: 2, // Use `Infinity` when disabling scroll.
              scrollbarStyle: "overlay",
              tabSize: 4,
              mode: "python",
              theme: "monokai"
            }
          );

          // Add event handlers to CodeMirror instance.
          this.codeMirror.on("keyup", update);
          this.codeMirror.on("mousemove", update);
          let scrollElement = this.codeMirror.getScrollerElement();
          scrollElement.addEventListener('mousemove', update); 
          scrollElement.addEventListener('scroll', update);

          this.sizeUpdate(); // Calculate and set the initial size.
        }

        sizeUpdate () {
          const height = (18 * this.lines) + 7;
          const width = (document.getElementById("header").offsetWidth - this.sidebar) / 2;
          this.element.style.width = width + "px";
          const codeMirrorElement = document.getElementsByClassName("CodeMirror")[0];
          codeMirrorElement.style.width = width + "px";
          this.codeMirror.setSize(width, height);
          this.height = this.element.offsetHeight;
          this.width = width;
        }
      }

      class Report {
        constructor (elementId, editor) {
          this.element = document.getElementById(elementId);
          this.cache = {'source': null, 'analyses': null, 'report': null, 'rlines': null};
          this.editor = editor;

          this.sizeUpdate(); // Calculate and set the initial size.
        }

        sizeUpdate () {
          const height = this.editor.height, width = this.editor.width;
          this.element.parentElement.style.height = '493px';
          this.element.parentElement.style.width = width + 'px';
          this.element.style.height = '493px';
          this.element.style.width = width + 'px';
        }

        display (rlines) {
          // Use cached HTMl content if there is no updated data.
          if (rlines == null) {
            rlines = this.cache.rlines;
          } else {
            this.cache.rlines = rlines;
            this.cache.report = {};
          }

          // Configure visual properties and content for report.
          const horizontalScroll = this.editor.codeMirror.getScrollInfo().left;
          document.getElementById("report").setAttribute("style", "left:-" + horizontalScroll + "px");
          const scrollTop = $(window).scrollTop();
          const codeTop = document.querySelector(".CodeMirror-code").getBoundingClientRect().top;
          const rowFirst = 0 + Math.round(
            .5 + .77777 + 7 + this.editor.codeMirror.getViewport().from - ((codeTop + scrollTop) / 18)
          );

          // Build and display the report HTML.
          let linesOutput = [];
          for (let i = rowFirst; i < Math.min(rlines.length, rowFirst + this.editor.lines); i++) {
            const row = i + 1;
            if (row in this.cache.report) {
              linesOutput.push(this.cache.report[row]);
            } else {
              const html = rlines[i];
              linesOutput.push(html);
              this.cache.report[row] = html;
            }
          }
          document.getElementById("report").innerHTML = '<div id="detail"></div>' + linesOutput.join("");

          // Set up event handlers for detail tooltips.
          const elements = document.getElementsByClassName("detail");
          for (let i = 0; i < elements.length; i++) {
            const element = elements[i];
            element.addEventListener("mouseover", function (event) {
              const detail = document.getElementById("detail");
              detail.style.display = "block";
              detail.style.top = element.offsetTop + 24 + "px";
              detail.style.left = (
                element.offsetLeft +
                element.getBoundingClientRect().width -
                16
              ) + "px";
              detail.innerHTML = element.dataset.detail;
            });
            element.addEventListener("mouseout", function (event) { 
              const detail = document.getElementById("detail");
              detail.style.display = "none";
            });
          }
        }
      }

      class Interpreter {
        constructor (elementId) {
          this.element = document.getElementById(elementId);
          this.cache = {'inputs': {}, 'signature': null };
        }

        sizeUpdate (factor) {
          const width = (document.getElementById("header").offsetWidth - this.sidebar);
          this.element.style.width = width + "px";
        }

        inputsRetrieve () {
          let inputs = {};
          const elements = document.getElementsByClassName("input");
          for (let i = 0; i < elements.length; i++) {
            const element = elements[i];
            inputs[element.id] = parseInt(element.value);
          }
          return inputs;
        }

        inputsShow (ins) {
          const signature = ins.join(',');
          if (signature == this.cache.signature) {
            return;
          } else {
            this.cache.signature = signature;
          }

          const element = document.getElementById("inputs");
          element.innerHTML = "";
          const table = document.createElement("table");
          table.innerHTML = "<tr><td>Input Name</td><td>Input Value</td></tr>"
          for (let i = 0; i < ins.length; i++) {
            const tr = document.createElement("tr");
            const tdName = document.createElement("td");
            const name = ins[i];
            tdName.innerHTML = name;
            const tdValue = document.createElement("td");
            if (!(name in this.cache.inputs)) {
              this.cache.inputs[name] = 1 + Math.floor(Math.random() * 255);
            }
            const value = this.cache.inputs[name];
            tdValue.innerHTML = '<input class="input" id="' + name + '" type="number" value="' + value + '"/>';
            tr.appendChild(tdName);
            tr.appendChild(tdValue);
            table.appendChild(tr);
          }
          element.appendChild(table);

          const elements = document.getElementsByClassName("input");
          for (let i = 0; i < elements.length; i++) {
            const element = elements[i];
            const self = this;
            const upd = function () {
              self.cache.inputs[element.id] = parseInt(element.value);
              update(true);
            };
            element.addEventListener("keyup", upd);
            element.addEventListener("change", upd);
          }
        }

        outputsShow (outs) {
          const element = document.getElementById("outputs");
          element.innerHTML = "";
          const table = document.createElement("table");
          table.innerHTML = "<tr><td>Output Name</td><td>Output Value</td></tr>"
          for (let i = 0; i < outs.length; i++) {
            const tr = document.createElement("tr");
            const tdName = document.createElement("td");
            tdName.innerHTML = outs[i][0];
            const tdValue = document.createElement("td");
            tdValue.innerHTML = outs[i][1];
            tr.appendChild(tdName);
            tr.appendChild(tdValue);
            table.appendChild(tr);
          }
          element.appendChild(table);
        }
      }

      function update(force) {
        // General update of the entire workspace (called at every keyboard/scroll event,
        // and also programmatically).

        //$('.tooltip').remove();
        const source = editor.codeMirror.getValue();
        if (report.cache.analyses == null || source != report.cache.source || force) {
          report.cache.source = source;
          document.getElementById('payload').innerHTML = editor.codeMirror.getValue();
          document.dispatchEvent(new CustomEvent('update'));
        } else {
          report.display();
        }

        // Update the permanent link.
        document.getElementById("permalink").value = (
          location.protocol + '//' + location.host + location.pathname +
          '?s=' + btoa(editor.codeMirror.getValue())
        );
      }

      window.onload = async function () {
        const editorHeight = 27; // Vertical height of editor in lines.
        const managerWidth = 160; // Width of manager sidebar in pixels.

        editor = new Editor("editor", editorHeight, managerWidth, update);
        report = new Report("report", editor);
        interpreter = new Interpreter("interpreter");
        let manager = new Manager("manager", managerWidth, editor);

         // Resize components on window resize.
        const resize = function () {
          manager.sizeUpdate();
          editor.sizeUpdate();
          report.sizeUpdate();
          interpreter.sizeUpdate();
        }
        window.addEventListener('resize', resize, true);

        // Initialize and perform an initial update (in case working code is already present).
        manager.buildExampleMenu();
        manager.buildPermalinkButton();
        manager.loadInitialSource();
        resize();
        update();
      }

      // Globals and wrappers for Python.
      let editor = null;
      let report = null;
      let interpreter = null;
      function reportDisplay(rlines) { report.display(rlines); }
      function interpreterInputsRetrieve() { return interpreter.inputsRetrieve(); }
      function interpreterInputsShow(ins) { interpreter.inputsShow(ins); }
      function interpreterOutputsShow(outs) { interpreter.outputsShow(outs); }
    </script>
<pre class="example" id="multiplication_mixed_simple">
# The left-hand panel can scrolled and edited. The right-hand
# panel will automatically be updated with the results of the
# type checking and cost calculation static analyses. Green
# represents public Nada expressions/values and blue represents
# secret Nada expressions/values.

# On the right-hand panel, hover over variable names to see a
# count of the total number of *secret* operations that must be
# executed to determine the value of that variable at that point
# in the program. There is no deduplication (as in the current
# implementation).

from nada_audit import *

def nada_main():
    party1 = Party(name="Party1")
    my_int1 = PublicInteger(Input(name="my_int1", party=party1))
    my_int2 = SecretInteger(Input(name="my_int2", party=party1))

    new_int = my_int1 * my_int2

    return [Output(new_int, "my_output", party1)]
</pre>
<pre class="example" id="multiplication_mixed_larger">
from nada_audit import *

def nada_main():
    p1 = Party("Party1")
    p2 = Party("Party2")
    p3 = Party("Party3")
    p4 = Party("Party4")
    a = PublicInteger(Input("a", p1))
    b = SecretInteger(Input("b", p1))
    c = PublicInteger(Input("c", p2))
    d = SecretInteger(Input("d", p2))
    e = PublicInteger(Input("e", p3))
    f = SecretInteger(Input("f", p3))

    g = a * b * c * d * e * f

    return [Output(g, "g", p4)]
</pre>
<pre class="example" id="voting-functional-style">
from nada_audit import *

def nada_main():
    voters = [Party("Party" + str(v)) for v in range(2)]
    outparty = Party(name="OutParty")

    votes_per_candidate = [
        [
            SecretInteger(
                Input(
                    name="v" + str(v) + "_c" + str(c),
                    party=Party("Party" + str(v))
                )
            )
            for v in range(2)
        ]
        for c in range(4)
    ]

    return [
      Output(sum(votes_per_candidate[c]), "c" + str(c), outparty)
      for c in range(4)
    ]
</pre>
<pre class="example" id="voting-imperative-style">
# In this example, note that empty lists must be accompanied by an explicit
# type annotation.

from nada_audit import *

def nada_main():

    # Create the voter parties and recipient party.
    voters: list[Party] = []
    for v in range(2):
        voters.append(Party("Party" + str(v)))
    outparty = Party(name="OutParty")

    # Gather the inputs (one vote for each candidate from each voter).
    votes_per_candidate: list[list[SecretInteger]] = []
    for c in range(4):
        votes_per_candidate.append([])
        for v in range(2):
            votes_per_candidate[c].append(SecretInteger(
                Input(
                    name="v" + str(v) + "_c" + str(c),
                    party=Party("Party" + str(v))
                )
            ))

    # Calculate the total for each candidate.
    outputs: list[Output] = []
    for c in range(4):
        outputs.append(Output(sum(votes_per_candidate[c]), "c" + str(c), outparty))

    return outputs
</pre>
  </body>
</html>
